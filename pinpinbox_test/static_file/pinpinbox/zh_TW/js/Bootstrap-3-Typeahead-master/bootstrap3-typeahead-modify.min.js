(function(b,h){"undefined"!==typeof module&&module.exports?module.exports=h(require("jquery")):"function"===typeof define&&define.amd?define(["jquery"],function(b){return h(b)}):h(b.jQuery)})(this,function(b){var h=function(a,c){this.$element=b(a);this.options=b.extend({},b.fn.typeahead.defaults,c);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.select=this.options.select||this.select;this.autoSelect="boolean"==typeof this.options.autoSelect?this.options.autoSelect:
!0;this.highlighter=this.options.highlighter||this.highlighter;this.render=this.options.render||this.render;this.updater=this.options.updater||this.updater;this.displayText=this.options.displayText||this.displayText;this.source=this.options.source;this.delay=this.options.delay;this.$menu=b(this.options.menu);this.$appendTo=this.options.appendTo?b(this.options.appendTo):null;this.shown=!1;this.listen();this.showHintOnFocus="boolean"==typeof this.options.showHintOnFocus?this.options.showHintOnFocus:
!1;this.afterSelect=this.options.afterSelect;this.addItem=!1};h.prototype={constructor:h,click:function(a){a.preventDefault();this.select();this.$element.focus();this.hide()},destroy:function(){this.$element.data("typeahead",null);this.$element.data("active",null);this.$element.off("focus").off("blur").off("keypress").off("input").off("keyup");this.eventSupported("keydown")&&this.$element.off("keydown");this.$menu.remove()},focus:function(a){this.focused||(this.focused=!0,this.options.showHintOnFocus&&
(this.query===this.$element.val()?this.show():this.lookup()))},hide:function(){this.$menu.hide();this.shown=!1;return this},highlighter:function(a){var c=b("<div></div>"),g=this.query,e=a.toLowerCase().indexOf(g.toLowerCase()),d,f,k;d=g.length;if(0===d)return c.text(a).html();for(;-1<e;)f=a.substr(0,e),k=a.substr(e,d),a=a.substr(e+d),k=b("<strong></strong>").text(k),c.append(document.createTextNode(f)).append(k),e=a.toLowerCase().indexOf(g.toLowerCase());return c.append(document.createTextNode(a)).html()},
updater:function(a){return a},lookup:function(a){this.query="undefined"!=typeof a&&null!==a?a:this.$element.val()||"";if(this.query.length<this.options.minLength&&!this.options.showHintOnFocus)return this.shown?this.hide():this;a=b.proxy(function(){b.isFunction(this.source)?this.source(this.query,b.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker);this.lookupWorker=setTimeout(a,this.delay)},matcher:function(a){return~this.displayText(a).toLowerCase().indexOf(this.query.toLowerCase())},
process:function(a){var c=this;a=b.grep(a,function(a){return c.matcher(a)});a=this.sorter(a);0<a.length?this.$element.data("active",a[0]):this.$element.data("active",null);this.options.addItem&&a.push(this.options.addItem);return"all"==this.options.items?this.render(a).show():this.render(a.slice(0,this.options.items)).show()},render:function(a){var c=this,g=this,e=!1,d=[],f=c.options.separator;b.each(a,function(b,c){0<b&&c[f]!==a[b-1][f]&&d.push({__type:"divider"});!c[f]||0!==b&&c[f]===a[b-1][f]||
d.push({__type:"category",name:c[f]});d.push(c)});a=b(d).map(function(a,d){if("category"==(d.__type||!1))return b(c.options.headerHtml).text(d.name)[0];if("divider"==(d.__type||!1))return b(c.options.headerDivider)[0];var f=g.displayText(d);a=b(c.options.item).data("value",d);a.find("a").html(c.highlighter(f,d));f==g.$element.val()&&(a.addClass("active"),g.$element.data("active",d),e=!0);return a[0]});this.autoSelect&&!e&&(a.filter(":not(.dropdown-header)").first().addClass("active"),this.$element.data("active",
a.first().data("value")));this.$menu.html(a);return this},select:function(){var a=this.$menu.find(".active").data("value");this.$element.data("active",a);if(this.autoSelect||a)(a=this.updater(a))||(a=""),a=this.displayText(a)||a,this.$element.val(a).change(),this.query=a,this.afterSelect(a);return this.hide()},setSource:function(a){this.source=a},show:function(){if(""===this.$menu.html())this.shown&&this.hide();else{var a=b.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight}),
c;c="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight;(this.shown?this.$menu:this.$appendTo?this.$menu.appendTo(this.$appendTo):this.$menu.insertAfter("body")).css({top:a.top+a.height+c,left:a.left}).show();this.shown=!0}return this},sorter:function(a){for(var b=[],g=[],e=[],d;d=a.shift();){var f=this.displayText(d);f.toLowerCase().indexOf(this.query.toLowerCase())?~f.indexOf(this.query)?g.push(d):e.push(d):b.push(d)}return b.concat(g,e)},displayText:function(a){return"undefined"!==
typeof a&&"undefined"!=typeof a.name&&a.name||a},next:function(a){a=this.$menu.find(".active").removeClass("active").next();a.length||(a=b(this.$menu.find("li")[0]));a.addClass("active")},prev:function(a){a=this.$menu.find(".active").removeClass("active").prev();a.length||(a=this.$menu.find("li").last());a.addClass("active")},listen:function(){this.$element.on("focus",b.proxy(this.focus,this)).on("blur",b.proxy(this.blur,this)).on("keypress",b.proxy(this.keypress,this)).on("input",b.proxy(this.input,
this)).on("keyup",b.proxy(this.keyup,this));if(this.eventSupported("keydown"))this.$element.on("keydown",b.proxy(this.keydown,this));this.$menu.on("click",b.proxy(this.click,this)).on("mouseenter","li",b.proxy(this.mouseenter,this)).on("mouseleave","li",b.proxy(this.mouseleave,this))},eventSupported:function(a){var b=a in this.$element;b||(this.$element.setAttribute(a,"return;"),b="function"===typeof this.$element[a]);return b},move:function(a){if(this.shown)switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();
break;case 38:if(a.shiftKey)break;a.preventDefault();this.prev();break;case 40:a.shiftKey||(a.preventDefault(),this.next())}},keydown:function(a){this.suppressKeyPressRepeat=~b.inArray(a.keyCode,[40,38,9,13,27]);this.shown||40!=a.keyCode?this.move(a):this.lookup()},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},input:function(a){this.lookup();a.preventDefault()},keyup:function(a){switch(a.keyCode){case 9:case 13:if(!this.shown)return;0<this.$menu.find(".active").length&&this.select();
break;case 27:if(!this.shown)return;this.hide()}a.preventDefault()},blur:function(a){this.focused=!1;!this.mousedover&&this.shown&&this.hide()},mouseenter:function(a){this.mousedover=!0;this.$menu.find(".active").removeClass("active");b(a.currentTarget).addClass("active")},mouseleave:function(a){this.mousedover=!1;this.$menu.find(".active").removeClass("active");!this.focused&&this.shown&&this.hide()}};var l=b.fn.typeahead;b.fn.typeahead=function(a){var c=arguments;return"string"==typeof a&&"getActive"==
a?this.data("active"):this.each(function(){var g=b(this),e=g.data("typeahead"),d="object"==typeof a&&a;e||g.data("typeahead",e=new h(this,d));if("string"==typeof a&&e[a])if(1<c.length)e[a].apply(e,Array.prototype.slice.call(c,1));else e[a]()})};b.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu" role="listbox"></ul>',item:'<li><a class="dropdown-item" href="#" role="option"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:b.noop,addItem:!1,delay:0,separator:"category",
headerHtml:'<li class="dropdown-header"></li>',headerDivider:'<li class="divider" role="separator"></li>'};b.fn.typeahead.Constructor=h;b.fn.typeahead.noConflict=function(){b.fn.typeahead=l;return this};b(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(a){a=b(this);a.data("typeahead")||a.typeahead(a.data())})});